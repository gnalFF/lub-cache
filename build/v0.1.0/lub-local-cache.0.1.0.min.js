/**
 * AngularJS Local Cache Module
 * @version v0.1.0 - 2013-02-09
 * @link https://github.com/gnalFF/lub-local-cache
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("lub-storage",[]).factory("lubStorage",function(e){var t={};return function(n,r){var i=angular.extend({storage:"localStorage",ttl:0},r),s={},o=0,u=e[i.storage];if(t[n])throw{name:"CacheExists"};var a=u[n];if(a){s=JSON.parse(a);for(var f in s)Object.prototype.hasOwnProperty.call(s,f)&&(o+=1)}return t[n]={setItem:function(e,t,r){this.data[e]=this.$toCacheObject(t,r),this.length=this.length+1,u[n]=JSON.stringify(this.data)},getItem:function(e){return this.$cacheObject(e).data},removeItem:function(e){if(this.length===0)return;delete this.data[e],this.length=this.length-1,u[n]=JSON.stringify(this.data)},clear:function(){this.data={},delete u[n],this.length=0},info:function(){return{name:n,ttl:i.ttl,length:this.length}},data:s,length:o,$cacheObject:function(e){var t={data:undefined},n=this.data[e]||t;return n.expires?this.$getTime()<=n.expires?n:(this.removeItem(e),t):n},$getTime:function(){return(new Date).getTime()},$toCacheObject:function(e,t){var n=angular.extend({ttl:0},i,t),r={data:e};return angular.isNumber(n.ttl)&&n.ttl>0&&(r.expires=this.$getTime()+n.ttl),r}}}}),angular.module("lub-cache",["lub-storage"]).factory("lubCache",function(e,t){return function(n,r){return{info:function(){return this.$cache.info()},put:function(e,t,n){this.$cache.setItem(e,t,n)},get:function(e){return this.$cache.getItem(e)},remove:function(e){this.$cache.removeItem(e)},removeAll:function(){this.$cache.clear()},destroy:function(){t.debug("will just invoke removeAll"),this.removeAll()},$cache:e(n,angular.extend({ttl:0,storage:"localStorage"},r))}}});